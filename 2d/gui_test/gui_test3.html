<html>
<head>
<meta charset="utf-8">
<title>js validation test</title>
<script type="text/javascript" src="../../wgeCore.js"></script>
<script type="text/javascript" src="../../wgeMatrix.js"></script>
<script type="text/javascript" src="../../wgeGUI.js"></script>
<script type="text/javascript" src="../../wgeAnimation.js"></script>
<script type="text/javascript" src="../wgeSprite.js"></script>
<style type="text/css">
input {
	width: 100px;
}
</style>
</head>
<body onload="isOK = true; window.img = WGE.ID('test0');">
<script type="text/javascript">

var timeline = new WGE.TimeLine(10000000); //给bendemo足够长时间。。。
var isOK = false;

var mySprite = WGE.Class(WGE.Sprite, WGE.AnimationInterface,
{
	initialize : function(startTime, endTime, img, w, h)
	{
		this.setAttrib(startTime, endTime);
		this.timeActions = [];
		if(img)
		{
			this.initSprite(img, w, h);
		}
	}
});

var myGUI = WGE.Class(WGE.GUIInterface, 
{
	context : undefined,
	x : 0,
	y : 0,
	isMouseDown : false,

	bindFather : function(fatherObj)
	{
		if(WGE.GUIInterface.bindFather.call(this, fatherObj));
		{
			this.context = this.canvas.getContext('2d');
			if(!this.context)
			{
				alert('你的浏览器不支持html5啊，坟蛋！换一个好吗？');
			}
			return !!this.context;
		}
		return false;
	},

	update : function(dt)
	{
		if(!timeline.update(dt))
		{
			this.stop();
			console.log("end");
		}
	},

	render : function()
	{
		this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
		timeline.render(this.context);
	}
	
});

var div = WGE.CE('div');
div.setAttribute("style", "width:100%;height:100%;background-color:#000");
div.setAttribute("tabindex", 0);
document.body.appendChild(div);
window.gui = new myGUI(div);

//下面两句都是使整个ui大小跟随父元素变化，推荐前者。嫌麻烦或者跟已有代码有冲突（比如body的onresize有别的代码会随时更改）写成后者也没关系。
document.body.setAttribute("onresize", "gui.onresize(event);"); //较好
//gui.forceAutoResize(true); //这一句和上一句功能类似，这种方法可保证正确性

</script>

<div style="position:absolute;top:10px;left:10px;width:200px;height:auto;background-color:#f00;filter:alpha(Opacity=80);-moz-opacity:0.8;opacity:0.8;">
重复次数:<input type="number" value="1" id="repeatTimes"><br>
Sprite起始:<input type="number" value="0" id="spriteStartTime"><br>
Sprite结束:<input type="number" value="2000" id="spriteEndTime"><br>
Action起始:<input type="number" value="500" id="actionStartTime"><br>
Action结束:<input type="number" value="1500" id="actionEndTime"><br>
x重心：<input type="number" value="0.5" id="hotspotX"><br>
y重心：<input type="number" value="0.5" id="hotspotY"><br>
(0.5为中心点)<br><br>
动作列表:<br>
<input type="button" onclick="" value="匀速移动0"><br>
<input type="button" onclick="" value="变速移动1"><br>
<input type="button" onclick="" value="变速移动2"><br>
<input type="button" onclick="" value="变速移动3"><br>
<input type="button" onclick="" value="透明"><br>
<input type="button" onclick="" value="闪烁"><br>
<input type="button" onclick="" value="旋转"><br>
<input type="button" onclick="" value="缩放"><br>
<input type="button" onclick="" value="组合动作"><br>
</div>

<script type="text/javascript">

function move0()
{
	var sprite = new mySprite(200, 4000, img, -1);
	sprite.moveTo(500, 500);
	sprite.setHotspot2Center();

	var action = new WGE.UniformScaleAction([0, 3500], [1.3, 1.3], [0.5, 0.5], 5);
	var action2 = new WGE.BlinkAlphaAction([500, 3500], 0, 1, 3);

	//sprite.push(action);
	sprite.push(action2);

	timeline.push(sprite);
	timeline.start(0);
}

</script>

<div style="display:none"><img src="../../res/png/0.png" id="test0"></div>
</body>
</html>